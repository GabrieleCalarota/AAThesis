
    




    
\documentclass[11pt]{article}

    
    \usepackage[breakable]{tcolorbox}
    \tcbset{nobeforeafter} % prevents tcolorboxes being placing in paragraphs
    \usepackage{float}
    \floatplacement{figure}{H} % forces figures to be placed at the correct location
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    \usepackage{mathrsfs}
    

    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}
    \definecolor{ansi-default-inverse-fg}{HTML}{FFFFFF}
    \definecolor{ansi-default-inverse-bg}{HTML}{000000}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatibility definitions
    \def\gt{>}
    \def\lt{<}
    \let\Oldtex\TeX
    \let\Oldlatex\LaTeX
    \renewcommand{\TeX}{\textrm{\Oldtex}}
    \renewcommand{\LaTeX}{\textrm{\Oldlatex}}
    % Document parameters
    % Document title
    \title{svm\_aa\_rcv1\_open\_set}
    
    
    
    
    
% Pygments definitions
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % For linebreaks inside Verbatim environment from package fancyvrb. 
    \makeatletter
        \newbox\Wrappedcontinuationbox 
        \newbox\Wrappedvisiblespacebox 
        \newcommand*\Wrappedvisiblespace {\textcolor{red}{\textvisiblespace}} 
        \newcommand*\Wrappedcontinuationsymbol {\textcolor{red}{\llap{\tiny$\m@th\hookrightarrow$}}} 
        \newcommand*\Wrappedcontinuationindent {3ex } 
        \newcommand*\Wrappedafterbreak {\kern\Wrappedcontinuationindent\copy\Wrappedcontinuationbox} 
        % Take advantage of the already applied Pygments mark-up to insert 
        % potential linebreaks for TeX processing. 
        %        {, <, #, %, $, ' and ": go to next line. 
        %        _, }, ^, &, >, - and ~: stay at end of broken line. 
        % Use of \textquotesingle for straight quote. 
        \newcommand*\Wrappedbreaksatspecials {% 
            \def\PYGZus{\discretionary{\char`\_}{\Wrappedafterbreak}{\char`\_}}% 
            \def\PYGZob{\discretionary{}{\Wrappedafterbreak\char`\{}{\char`\{}}% 
            \def\PYGZcb{\discretionary{\char`\}}{\Wrappedafterbreak}{\char`\}}}% 
            \def\PYGZca{\discretionary{\char`\^}{\Wrappedafterbreak}{\char`\^}}% 
            \def\PYGZam{\discretionary{\char`\&}{\Wrappedafterbreak}{\char`\&}}% 
            \def\PYGZlt{\discretionary{}{\Wrappedafterbreak\char`\<}{\char`\<}}% 
            \def\PYGZgt{\discretionary{\char`\>}{\Wrappedafterbreak}{\char`\>}}% 
            \def\PYGZsh{\discretionary{}{\Wrappedafterbreak\char`\#}{\char`\#}}% 
            \def\PYGZpc{\discretionary{}{\Wrappedafterbreak\char`\%}{\char`\%}}% 
            \def\PYGZdl{\discretionary{}{\Wrappedafterbreak\char`\$}{\char`\$}}% 
            \def\PYGZhy{\discretionary{\char`\-}{\Wrappedafterbreak}{\char`\-}}% 
            \def\PYGZsq{\discretionary{}{\Wrappedafterbreak\textquotesingle}{\textquotesingle}}% 
            \def\PYGZdq{\discretionary{}{\Wrappedafterbreak\char`\"}{\char`\"}}% 
            \def\PYGZti{\discretionary{\char`\~}{\Wrappedafterbreak}{\char`\~}}% 
        } 
        % Some characters . , ; ? ! / are not pygmentized. 
        % This macro makes them "active" and they will insert potential linebreaks 
        \newcommand*\Wrappedbreaksatpunct {% 
            \lccode`\~`\.\lowercase{\def~}{\discretionary{\hbox{\char`\.}}{\Wrappedafterbreak}{\hbox{\char`\.}}}% 
            \lccode`\~`\,\lowercase{\def~}{\discretionary{\hbox{\char`\,}}{\Wrappedafterbreak}{\hbox{\char`\,}}}% 
            \lccode`\~`\;\lowercase{\def~}{\discretionary{\hbox{\char`\;}}{\Wrappedafterbreak}{\hbox{\char`\;}}}% 
            \lccode`\~`\:\lowercase{\def~}{\discretionary{\hbox{\char`\:}}{\Wrappedafterbreak}{\hbox{\char`\:}}}% 
            \lccode`\~`\?\lowercase{\def~}{\discretionary{\hbox{\char`\?}}{\Wrappedafterbreak}{\hbox{\char`\?}}}% 
            \lccode`\~`\!\lowercase{\def~}{\discretionary{\hbox{\char`\!}}{\Wrappedafterbreak}{\hbox{\char`\!}}}% 
            \lccode`\~`\/\lowercase{\def~}{\discretionary{\hbox{\char`\/}}{\Wrappedafterbreak}{\hbox{\char`\/}}}% 
            \catcode`\.\active
            \catcode`\,\active 
            \catcode`\;\active
            \catcode`\:\active
            \catcode`\?\active
            \catcode`\!\active
            \catcode`\/\active 
            \lccode`\~`\~ 	
        }
    \makeatother

    \let\OriginalVerbatim=\Verbatim
    \makeatletter
    \renewcommand{\Verbatim}[1][1]{%
        %\parskip\z@skip
        \sbox\Wrappedcontinuationbox {\Wrappedcontinuationsymbol}%
        \sbox\Wrappedvisiblespacebox {\FV@SetupFont\Wrappedvisiblespace}%
        \def\FancyVerbFormatLine ##1{\hsize\linewidth
            \vtop{\raggedright\hyphenpenalty\z@\exhyphenpenalty\z@
                \doublehyphendemerits\z@\finalhyphendemerits\z@
                \strut ##1\strut}%
        }%
        % If the linebreak is at a space, the latter will be displayed as visible
        % space at end of first line, and a continuation symbol starts next line.
        % Stretch/shrink are however usually zero for typewriter font.
        \def\FV@Space {%
            \nobreak\hskip\z@ plus\fontdimen3\font minus\fontdimen4\font
            \discretionary{\copy\Wrappedvisiblespacebox}{\Wrappedafterbreak}
            {\kern\fontdimen2\font}%
        }%
        
        % Allow breaks at special characters using \PYG... macros.
        \Wrappedbreaksatspecials
        % Breaks at punctuation characters . , ; ? ! and / need catcode=\active 	
        \OriginalVerbatim[#1,codes*=\Wrappedbreaksatpunct]%
    }
    \makeatother

    % Exact colors from NB
    \definecolor{incolor}{HTML}{303F9F}
    \definecolor{outcolor}{HTML}{D84315}
    \definecolor{cellborder}{HTML}{CFCFCF}
    \definecolor{cellbackground}{HTML}{F7F7F7}
    
    % prompt
    \newcommand{\prompt}[4]{
        \llap{{\color{#2}[#3]: #4}}\vspace{-1.25em}
    }
    

    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    \section{Gabriele Calarota}\label{gabriele-calarota}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{1}{\hspace{4pt}}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{google}\PY{n+nn}{.}\PY{n+nn}{colab} \PY{k}{import} \PY{n}{drive}
\PY{n}{drive}\PY{o}{.}\PY{n}{mount}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/content/drive}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Mounted at /content/drive
\end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{2}{\hspace{4pt}}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{NUM\PYZus{}AUTHORS} \PY{o}{=} \PY{l+m+mi}{50}
\PY{n}{N\PYZus{}DOCS} \PY{o}{=} \PY{l+m+mi}{100}
\PY{n}{N\PYZus{}THRESHOLD} \PY{o}{=} \PY{k+kc}{None}
\PY{n}{USE\PYZus{}BOW}\PY{o}{=}\PY{k+kc}{False}
\PY{n}{USE\PYZus{}TFIDF}\PY{o}{=}\PY{k+kc}{True}
\PY{n}{USE\PYZus{}W2V}\PY{o}{=}\PY{k+kc}{False}
\PY{n}{OPEN\PYZus{}SET} \PY{o}{=} \PY{k+kc}{True}
\PY{n}{OPEN\PYZus{}SET\PYZus{}NUM\PYZus{}AUTHORS}\PY{o}{=}\PY{l+m+mi}{5}
\PY{n}{PROJECT\PYZus{}NAME} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{RCV1}\PY{l+s+s2}{\PYZdq{}}
\PY{n}{DATASET\PYZus{}FILENAME} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Reuteurs/RCV1/rcv1\PYZus{}ccat\PYZus{}parsed\PYZus{}renamed.csv}\PY{l+s+s1}{\PYZsq{}}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{3}{\hspace{4pt}}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{o}{!}pip install \PYZhy{}q tpot
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
     |████████████████████████████████| 92kB 6.1MB/s
     |████████████████████████████████| 163kB 14.3MB/s
     |████████████████████████████████| 157.5MB 104kB/s
  Building wheel for stopit (setup.py) {\ldots} done
\end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{4}{\hspace{4pt}}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{os}
\PY{k+kn}{import} \PY{n+nn}{re}
\PY{k+kn}{from} \PY{n+nn}{io} \PY{k}{import} \PY{n}{StringIO}

\PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
\PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
\PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
\PY{k+kn}{import} \PY{n+nn}{seaborn} \PY{k}{as} \PY{n+nn}{sns}
\PY{k+kn}{import} \PY{n+nn}{tensorflow} \PY{k}{as} \PY{n+nn}{tf}
\PY{k+kn}{import} \PY{n+nn}{xgboost} \PY{k}{as} \PY{n+nn}{xgb}
\PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline

\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{svm} \PY{k}{import} \PY{n}{SVC}
\PY{k+kn}{from} \PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{models} \PY{k}{import} \PY{n}{Sequential}
\PY{k+kn}{from} \PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{layers}\PY{n+nn}{.}\PY{n+nn}{recurrent} \PY{k}{import} \PY{n}{LSTM}\PY{p}{,} \PY{n}{GRU}
\PY{k+kn}{from} \PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{layers}\PY{n+nn}{.}\PY{n+nn}{core} \PY{k}{import} \PY{n}{Dense}\PY{p}{,} \PY{n}{Activation}\PY{p}{,} \PY{n}{Dropout}
\PY{k+kn}{from} \PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{layers}\PY{n+nn}{.}\PY{n+nn}{embeddings} \PY{k}{import} \PY{n}{Embedding}
\PY{k+kn}{from} \PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{layers}\PY{n+nn}{.}\PY{n+nn}{normalization} \PY{k}{import} \PY{n}{BatchNormalization}
\PY{k+kn}{from} \PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{utils} \PY{k}{import} \PY{n}{np\PYZus{}utils}\PY{p}{,} \PY{n}{to\PYZus{}categorical}
\PY{k+kn}{from} \PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{preprocessing}\PY{n+nn}{.}\PY{n+nn}{text} \PY{k}{import} \PY{n}{Tokenizer}
\PY{k+kn}{from} \PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{preprocessing}\PY{n+nn}{.}\PY{n+nn}{sequence} \PY{k}{import} \PY{n}{pad\PYZus{}sequences}
\PY{k+kn}{from} \PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{callbacks} \PY{k}{import} \PY{n}{EarlyStopping}
\PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k}{import} \PY{n}{preprocessing}\PY{p}{,} \PY{n}{decomposition}\PY{p}{,} \PY{n}{model\PYZus{}selection}\PY{p}{,} \PY{n}{metrics}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{pipeline} \PY{k}{import} \PY{n}{Pipeline}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k}{import} \PY{n}{GridSearchCV}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{feature\PYZus{}extraction}\PY{n+nn}{.}\PY{n+nn}{text} \PY{k}{import} \PY{n}{TfidfVectorizer}\PY{p}{,} \PY{n}{CountVectorizer}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{ensemble} \PY{k}{import} \PY{n}{RandomForestClassifier}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{preprocessing} \PY{k}{import} \PY{n}{LabelEncoder}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{decomposition} \PY{k}{import} \PY{n}{TruncatedSVD}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{linear\PYZus{}model} \PY{k}{import} \PY{n}{LogisticRegression}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k}{import} \PY{n}{train\PYZus{}test\PYZus{}split}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{naive\PYZus{}bayes} \PY{k}{import} \PY{n}{MultinomialNB}\PY{p}{,} \PY{n}{BernoulliNB}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{decomposition} \PY{k}{import} \PY{n}{KernelPCA}\PY{p}{,} \PY{n}{PCA}
\PY{k+kn}{from} \PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{layers} \PY{k}{import} \PY{n}{GlobalAvgPool1D}\PY{p}{,} \PY{n}{Conv1D}\PY{p}{,} \PY{n}{MaxPooling1D}\PY{p}{,} \PY{n}{Flatten}\PY{p}{,} \PY{n}{Bidirectional}\PY{p}{,} \PY{n}{SpatialDropout1D}\PY{p}{,} \PY{n}{AveragePooling1D}
\PY{k+kn}{from} \PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{preprocessing} \PY{k}{import} \PY{n}{sequence}\PY{p}{,} \PY{n}{text}
\PY{k+kn}{from} \PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{callbacks} \PY{k}{import} \PY{n}{EarlyStopping}
\PY{k+kn}{from} \PY{n+nn}{keras} \PY{k}{import} \PY{n}{backend} \PY{k}{as} \PY{n}{K}
\PY{k+kn}{import} \PY{n+nn}{nltk}
\PY{k+kn}{from} \PY{n+nn}{nltk} \PY{k}{import} \PY{n}{word\PYZus{}tokenize}
\PY{k+kn}{from} \PY{n+nn}{nltk}\PY{n+nn}{.}\PY{n+nn}{stem}\PY{n+nn}{.}\PY{n+nn}{wordnet} \PY{k}{import} \PY{n}{WordNetLemmatizer}
\PY{k+kn}{from} \PY{n+nn}{nltk}\PY{n+nn}{.}\PY{n+nn}{corpus} \PY{k}{import} \PY{n}{wordnet} \PY{k}{as} \PY{n}{wn}
\PY{k+kn}{from} \PY{n+nn}{nltk}\PY{n+nn}{.}\PY{n+nn}{corpus} \PY{k}{import} \PY{n}{stopwords}
\PY{k+kn}{from} \PY{n+nn}{nltk}\PY{n+nn}{.}\PY{n+nn}{stem}\PY{n+nn}{.}\PY{n+nn}{snowball} \PY{k}{import} \PY{n}{SnowballStemmer}
\PY{k+kn}{import} \PY{n+nn}{tarfile}
\PY{k+kn}{import} \PY{n+nn}{zipfile}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k}{import} \PY{n}{train\PYZus{}test\PYZus{}split}
\PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
\PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{feature\PYZus{}selection} \PY{k}{import} \PY{n}{SelectFwe}\PY{p}{,} \PY{n}{f\PYZus{}classif}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k}{import} \PY{n}{train\PYZus{}test\PYZus{}split}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{pipeline} \PY{k}{import} \PY{n}{make\PYZus{}pipeline}\PY{p}{,} \PY{n}{make\PYZus{}union}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{svm} \PY{k}{import} \PY{n}{LinearSVC}
\PY{k+kn}{from} \PY{n+nn}{tpot}\PY{n+nn}{.}\PY{n+nn}{builtins} \PY{k}{import} \PY{n}{StackingEstimator}
\PY{k+kn}{from} \PY{n+nn}{tpot}\PY{n+nn}{.}\PY{n+nn}{export\PYZus{}utils} \PY{k}{import} \PY{n}{set\PYZus{}param\PYZus{}recursive}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{preprocessing} \PY{k}{import} \PY{n}{FunctionTransformer}
\PY{k+kn}{from} \PY{n+nn}{copy} \PY{k}{import} \PY{n}{copy}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{accuracy\PYZus{}score}\PY{p}{,} \PY{n}{precision\PYZus{}score}\PY{p}{,} \PY{n}{recall\PYZus{}score}\PY{p}{,} \PY{n}{f1\PYZus{}score}\PY{p}{,} \PY{n}{precision\PYZus{}recall\PYZus{}curve}\PY{p}{,} \PY{n}{classification\PYZus{}report}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
/usr/local/lib/python3.6/dist-packages/sklearn/externals/six.py:31:
FutureWarning: The module is deprecated in version 0.21 and will be removed in
version 0.23 since we've dropped support for Python 2.7. Please rely on the
official version of six (https://pypi.org/project/six/).
  "(https://pypi.org/project/six/).", FutureWarning)
/usr/local/lib/python3.6/dist-packages/sklearn/utils/deprecation.py:144:
FutureWarning: The sklearn.neighbors.base module is  deprecated in version 0.22
and will be removed in version 0.24. The corresponding classes / functions
should instead be imported from sklearn.neighbors. Anything that cannot be
imported from sklearn.neighbors is now part of the private API.
  warnings.warn(message, FutureWarning)
\end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{5}{\hspace{4pt}}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{base\PYZus{}dir} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/content/drive/Shared drives/Tesi\PYZus{}AuthorshipAttribution\PYZus{}Calarota/Dataset/}\PY{l+s+s1}{\PYZsq{}}
\PY{c+c1}{\PYZsh{}base\PYZus{}dir = \PYZdq{}\PYZdq{}}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{6}{\hspace{4pt}}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{print\PYZus{}stats\PYZus{}dataset}\PY{p}{(}\PY{n}{dataframe}\PY{p}{)}\PY{p}{:}
  \PY{n}{num\PYZus{}text\PYZus{}total} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{dataframe}\PY{p}{)}
  \PY{n}{df\PYZus{}group\PYZus{}by\PYZus{}author} \PY{o}{=} \PY{n}{dataframe}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{author}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
  \PY{n}{df\PYZus{}count} \PY{o}{=} \PY{n}{df\PYZus{}group\PYZus{}by\PYZus{}author}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{articles}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{count}\PY{p}{(}\PY{p}{)}
  \PY{n}{num\PYZus{}of\PYZus{}authors} \PY{o}{=} \PY{n}{df\PYZus{}group\PYZus{}by\PYZus{}author}\PY{o}{.}\PY{n}{size}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{name}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{counts}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{count}\PY{p}{(}\PY{p}{)}
  \PY{n}{num\PYZus{}text\PYZus{}per\PYZus{}author\PYZus{}mean}\PY{o}{=}\PY{n}{df\PYZus{}group\PYZus{}by\PYZus{}author}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{articles}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{count}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}
  \PY{n}{text\PYZus{}length\PYZus{}per\PYZus{}author}\PY{o}{=}\PY{n}{df\PYZus{}group\PYZus{}by\PYZus{}author}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{articles}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{apply}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{x}\PY{o}{.}\PY{n}{str}\PY{o}{.}\PY{n}{len}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{name}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean\PYZus{}len\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
  \PY{n+nb}{print}\PY{p}{(}\PY{n}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Numero di testi totale: }\PY{l+s+si}{\PYZob{}num\PYZus{}text\PYZus{}total\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
  \PY{n+nb}{print}\PY{p}{(}\PY{n}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Numero di testi per autore in media: }\PY{l+s+si}{\PYZob{}num\PYZus{}text\PYZus{}per\PYZus{}author\PYZus{}mean\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
  \PY{n+nb}{print}\PY{p}{(}\PY{n}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Numero di autori: }\PY{l+s+si}{\PYZob{}num\PYZus{}of\PYZus{}authors[\PYZsq{}author\PYZsq{}]\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
  \PY{n+nb}{print}\PY{p}{(}\PY{n}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Lunghezza media testo per autore in media: }\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{text\PYZus{}length\PYZus{}per\PYZus{}author[}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{mean\PYZus{}len\PYZus{}text}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{].mean()\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{7}{\hspace{4pt}}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{dataset} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{base\PYZus{}dir}\PY{p}{,} \PY{n}{DATASET\PYZus{}FILENAME}\PY{p}{)}\PY{p}{)} 
\PY{n}{dataset}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, boxrule=.5pt, size=fbox, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{7}{\hspace{3.5pt}}
\begin{Verbatim}[commandchars=\\\{\}]
   Unnamed: 0  {\ldots}           author
0           1  {\ldots}     David Lawder
1           2  {\ldots}  Susan Zimmerman
2           3  {\ldots}  Susan Zimmerman
3           7  {\ldots}     Susan Nadeau
4           9  {\ldots}       Greg Frost

[5 rows x 3 columns]
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{8}{\hspace{4pt}}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{print\PYZus{}stats\PYZus{}dataset}\PY{p}{(}\PY{n}{dataset}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Numero di testi totale: 35667
Numero di testi per autore in media: 23.403543307086615
Numero di autori: 1524
Lunghezza media testo per autore in media: 3056.149551256315
\end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{9}{\hspace{4pt}}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{get\PYZus{}top\PYZus{}ten\PYZus{}authors}\PY{p}{(}\PY{n}{dataframe}\PY{p}{,} \PY{n}{number\PYZus{}prune}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{:}
  \PY{n}{df\PYZus{}group\PYZus{}by\PYZus{}author} \PY{o}{=} \PY{n}{dataframe}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{author}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
  \PY{n}{df\PYZus{}count} \PY{o}{=} \PY{n}{df\PYZus{}group\PYZus{}by\PYZus{}author}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{articles}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{count}\PY{p}{(}\PY{p}{)}
  \PY{n}{num\PYZus{}of\PYZus{}authors} \PY{o}{=} \PY{n}{df\PYZus{}group\PYZus{}by\PYZus{}author}\PY{o}{.}\PY{n}{size}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{name}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{counts}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
  \PY{n}{sorted\PYZus{}authors} \PY{o}{=} \PY{n}{num\PYZus{}of\PYZus{}authors}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{n}{by}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{counts}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ascending}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
  \PY{n}{id\PYZus{}of\PYZus{}author} \PY{o}{=} \PY{n}{sorted\PYZus{}authors}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{author}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{to\PYZus{}list}\PY{p}{(}\PY{p}{)}\PY{p}{[}\PY{p}{:}\PY{n}{number\PYZus{}prune}\PY{p}{]}
  \PY{k}{return} \PY{n}{id\PYZus{}of\PYZus{}author}

\PY{n}{list\PYZus{}of\PYZus{}top\PYZus{}ten\PYZus{}authors} \PY{o}{=} \PY{n}{get\PYZus{}top\PYZus{}ten\PYZus{}authors}\PY{p}{(}\PY{n}{dataset}\PY{p}{,} \PY{n}{number\PYZus{}prune}\PY{o}{=}\PY{n}{NUM\PYZus{}AUTHORS}\PY{p}{)}
\PY{n}{dataset} \PY{o}{=} \PY{n}{dataset}\PY{p}{[}\PY{n}{dataset}\PY{o}{.}\PY{n}{author}\PY{o}{.}\PY{n}{isin}\PY{p}{(}\PY{n}{list\PYZus{}of\PYZus{}top\PYZus{}ten\PYZus{}authors}\PY{p}{)}\PY{p}{]}
\PY{n}{print\PYZus{}stats\PYZus{}dataset}\PY{p}{(}\PY{n}{dataset}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Numero di testi totale: 8978
Numero di testi per autore in media: 179.56
Numero di autori: 50
Lunghezza media testo per autore in media: 3208.73313196705
\end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{10}{\hspace{4pt}}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{get\PYZus{}only\PYZus{}n\PYZus{}docs\PYZus{}for\PYZus{}authors}\PY{p}{(}\PY{n}{dataframe}\PY{p}{,} \PY{n}{n\PYZus{}docs}\PY{o}{=}\PY{l+m+mi}{200}\PY{p}{,} \PY{n}{threshold\PYZus{}document\PYZus{}length}\PY{o}{=}\PY{l+m+mi}{600}\PY{p}{)}\PY{p}{:}
  \PY{k}{if} \PY{n}{threshold\PYZus{}document\PYZus{}length} \PY{o+ow}{is} \PY{o+ow}{not} \PY{k+kc}{None}\PY{p}{:}
    \PY{n}{dataframe} \PY{o}{=} \PY{n}{dataframe}\PY{p}{[}\PY{n}{dataframe}\PY{o}{.}\PY{n}{articles}\PY{o}{.}\PY{n}{str}\PY{o}{.}\PY{n}{len}\PY{p}{(}\PY{p}{)} \PY{o}{\PYZgt{}} \PY{n}{threshold\PYZus{}document\PYZus{}length}\PY{p}{]}
  \PY{k}{if} \PY{n}{n\PYZus{}docs} \PY{o+ow}{is} \PY{o+ow}{not} \PY{k+kc}{None}\PY{p}{:}
    \PY{n}{dataframe} \PY{o}{=} \PY{n}{dataframe}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{author}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{n}{n\PYZus{}docs}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{drop}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
  \PY{k}{return} \PY{n}{dataframe}
\PY{n}{dataset} \PY{o}{=} \PY{n}{get\PYZus{}only\PYZus{}n\PYZus{}docs\PYZus{}for\PYZus{}authors}\PY{p}{(}\PY{n}{dataset}\PY{p}{,} \PY{n}{n\PYZus{}docs}\PY{o}{=}\PY{n}{N\PYZus{}DOCS}\PY{p}{,} \PY{n}{threshold\PYZus{}document\PYZus{}length}\PY{o}{=}\PY{n}{N\PYZus{}THRESHOLD}\PY{p}{)}
\PY{n}{print\PYZus{}stats\PYZus{}dataset}\PY{p}{(}\PY{n}{dataset}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Numero di testi totale: 5000
Numero di testi per autore in media: 100.0
Numero di autori: 50
Lunghezza media testo per autore in media: 3162.113600000001
\end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{11}{\hspace{4pt}}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{dataset}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, boxrule=.5pt, size=fbox, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{11}{\hspace{3.5pt}}
\begin{Verbatim}[commandchars=\\\{\}]
   Unnamed: 0  {\ldots}              author
0           1  {\ldots}        David Lawder
1          10  {\ldots}    Patricia Commins
2          27  {\ldots}  Catherine O'Mahony
3          30  {\ldots}  Catherine O'Mahony
4          42  {\ldots}  Catherine O'Mahony

[5 rows x 3 columns]
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{12}{\hspace{4pt}}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{dataset}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{author}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, boxrule=.5pt, size=fbox, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{12}{\hspace{3.5pt}}
\begin{Verbatim}[commandchars=\\\{\}]
<matplotlib.axes.\_subplots.AxesSubplot at 0x7fab8fd17860>
\end{Verbatim}
\end{tcolorbox}
        
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{svm_aa_rcv1_open_set_files/svm_aa_rcv1_open_set_12_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    Train and test data are similarly distributed. An article can be
attributed to an author based on the topic and content of the article or
the author writing style or mix of both. In my basic approach, I will
try to solve the problem by leveraging the frequency of words in the
article, which represents the topic of an article. For this, I will
construct a TF-IDF matrix. I am not going to rely on the default
tokenizer provided by the scikit learn; I will create one for myself.
The custom tokenizer involved three steps:

\begin{itemize}
\tightlist
\item
  Tokenize the article into sentences and sentences into words
\item
  Filter the tokens with smaller lengths (assuming smaller words doesn't
  really say anything about the topic), whether a word is stop word or
  not, and whether the word is present in the dictionary or not
\item
  Stem the words
\end{itemize}

I am also going to construct a raw counts matrix as some models like
MultinomialNB often perform better on raw counts

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{13}{\hspace{4pt}}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{tokenize\PYZus{}and\PYZus{}stem}\PY{p}{(}\PY{n}{text}\PY{p}{)}\PY{p}{:}
    \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
\PY{l+s+sd}{    Below function tokenizes and lemmatizes the texts. It also does some cleaning by removing non dictionary words}
\PY{l+s+sd}{    This can be used to replace default tokenizer provided by feature extraction api of sklearn.}
\PY{l+s+sd}{    :param text: str}
\PY{l+s+sd}{    :return: list}
\PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}
    \PY{n}{stemmer} \PY{o}{=} \PY{n}{SnowballStemmer}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{english}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{stop\PYZus{}words} \PY{o}{=} \PY{n}{stopwords}\PY{o}{.}\PY{n}{words}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{english}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{tokens} \PY{o}{=} \PY{p}{[}\PY{n}{word}\PY{o}{.}\PY{n}{lower}\PY{p}{(}\PY{p}{)} \PY{k}{for} \PY{n}{sent} \PY{o+ow}{in} \PY{n}{nltk}\PY{o}{.}\PY{n}{sent\PYZus{}tokenize}\PY{p}{(}\PY{n}{text}\PY{p}{)} \PY{k}{for} \PY{n}{word} \PY{o+ow}{in} \PY{n}{nltk}\PY{o}{.}\PY{n}{word\PYZus{}tokenize}\PY{p}{(}\PY{n}{sent}\PY{p}{)}\PY{p}{]}
    \PY{n}{filtered\PYZus{}tokens} \PY{o}{=} \PY{p}{[}\PY{p}{]}
    \PY{k}{for} \PY{n}{token} \PY{o+ow}{in} \PY{n}{tokens}\PY{p}{:}
        \PY{k}{if} \PY{n}{re}\PY{o}{.}\PY{n}{search}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{[a\PYZhy{}zA\PYZhy{}Z\PYZhy{}]}\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{4,\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{token}\PY{p}{)} \PY{o+ow}{and} \PY{n}{token} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{stop\PYZus{}words} \PY{o+ow}{and} \PY{n+nb}{len}\PY{p}{(}\PY{n}{wn}\PY{o}{.}\PY{n}{synsets}\PY{p}{(}\PY{n}{token}\PY{p}{)}\PY{p}{)} \PY{o}{\PYZgt{}} \PY{l+m+mi}{0}\PY{p}{:}
            \PY{n}{token}\PY{o}{.}\PY{n}{strip}\PY{p}{(}\PY{p}{)}
            \PY{n}{filtered\PYZus{}tokens}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{token}\PY{p}{)}
    \PY{n}{filtered\PYZus{}tokens} \PY{o}{=} \PY{p}{[}\PY{n}{stemmer}\PY{o}{.}\PY{n}{stem}\PY{p}{(}\PY{n}{token}\PY{p}{)} \PY{k}{for} \PY{n}{token} \PY{o+ow}{in} \PY{n}{filtered\PYZus{}tokens}\PY{p}{]}
    \PY{k}{return} \PY{n}{filtered\PYZus{}tokens}
  
\PY{k}{def} \PY{n+nf}{simple\PYZus{}tokenizer}\PY{p}{(}\PY{n}{text}\PY{p}{)}\PY{p}{:}
    \PY{n}{text} \PY{o}{=} \PY{n}{re}\PY{o}{.}\PY{n}{sub}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{([\PYZca{}}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{]*)}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{text}\PY{p}{)}
    \PY{n}{tokens} \PY{o}{=} \PY{p}{[}\PY{n}{word}\PY{o}{.}\PY{n}{lower}\PY{p}{(}\PY{p}{)} \PY{k}{for} \PY{n}{sent} \PY{o+ow}{in} \PY{n}{nltk}\PY{o}{.}\PY{n}{sent\PYZus{}tokenize}\PY{p}{(}\PY{n}{text}\PY{p}{)} \PY{k}{for} \PY{n}{word} \PY{o+ow}{in} \PY{n}{nltk}\PY{o}{.}\PY{n}{word\PYZus{}tokenize}\PY{p}{(}\PY{n}{sent}\PY{p}{)}\PY{p}{]}
    \PY{n}{filtered\PYZus{}tokens} \PY{o}{=} \PY{p}{[}\PY{p}{]}
    \PY{k}{for} \PY{n}{token} \PY{o+ow}{in} \PY{n}{tokens}\PY{p}{:}
        \PY{k}{if} \PY{n+nb}{len}\PY{p}{(}\PY{n}{wn}\PY{o}{.}\PY{n}{synsets}\PY{p}{(}\PY{n}{token}\PY{p}{)}\PY{p}{)} \PY{o}{\PYZgt{}} \PY{l+m+mi}{0}\PY{p}{:}
            \PY{n}{token}\PY{o}{.}\PY{n}{strip}\PY{p}{(}\PY{p}{)}
            \PY{n}{filtered\PYZus{}tokens}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{token}\PY{p}{)}
    \PY{k}{return} \PY{n}{filtered\PYZus{}tokens}

\PY{c+c1}{\PYZsh{} custom\PYZus{}tokenizer = tokenize\PYZus{}and\PYZus{}stem}
\PY{n}{custom\PYZus{}tokenizer} \PY{o}{=} \PY{n}{simple\PYZus{}tokenizer}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{14}{\hspace{4pt}}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{tfidf\PYZus{}vec} \PY{o}{=} \PY{n}{TfidfVectorizer}\PY{p}{(}\PY{n}{max\PYZus{}df}\PY{o}{=}\PY{l+m+mf}{0.75}\PY{p}{,} \PY{n}{max\PYZus{}features}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,}
                            \PY{n}{min\PYZus{}df}\PY{o}{=}\PY{l+m+mf}{0.02}\PY{p}{,} \PY{n}{use\PYZus{}idf}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,} \PY{n}{tokenizer}\PY{o}{=}\PY{n}{custom\PYZus{}tokenizer}\PY{p}{,} \PY{n}{ngram\PYZus{}range}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}
\PY{n}{counter\PYZus{}vect} \PY{o}{=} \PY{n}{CountVectorizer}\PY{p}{(}\PY{n}{max\PYZus{}df}\PY{o}{=}\PY{l+m+mf}{0.8}\PY{p}{,} \PY{n}{max\PYZus{}features}\PY{o}{=}\PY{l+m+mi}{10000}\PY{p}{,}
                               \PY{n}{min\PYZus{}df}\PY{o}{=}\PY{l+m+mf}{0.02}\PY{p}{,} \PY{n}{tokenizer}\PY{o}{=}\PY{n}{custom\PYZus{}tokenizer}\PY{p}{,} \PY{n}{ngram\PYZus{}range}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{15}{\hspace{4pt}}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{nltk}
\PY{n}{nltk}\PY{o}{.}\PY{n}{download}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{stopwords}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{nltk}\PY{o}{.}\PY{n}{download}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{punkt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{nltk}\PY{o}{.}\PY{n}{download}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{wordnet}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
[nltk\_data] Downloading package stopwords to /root/nltk\_data{\ldots}
[nltk\_data]   Unzipping corpora/stopwords.zip.
[nltk\_data] Downloading package punkt to /root/nltk\_data{\ldots}
[nltk\_data]   Unzipping tokenizers/punkt.zip.
[nltk\_data] Downloading package wordnet to /root/nltk\_data{\ldots}
[nltk\_data]   Unzipping corpora/wordnet.zip.
\end{Verbatim}

            \begin{tcolorbox}[breakable, boxrule=.5pt, size=fbox, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{15}{\hspace{3.5pt}}
\begin{Verbatim}[commandchars=\\\{\}]
True
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{16}{\hspace{4pt}}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} Even split 50 \PYZam{} 50 per author and document}
\PY{n}{df\PYZus{}train} \PY{o}{=} \PY{n}{dataset}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{author}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{n}{N\PYZus{}DOCS}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{drop}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\PY{k}{if} \PY{n}{OPEN\PYZus{}SET}\PY{p}{:}
  \PY{n}{df\PYZus{}train} \PY{o}{=} \PY{n}{df\PYZus{}train}\PY{p}{[}\PY{n}{df\PYZus{}train}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{author}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{ngroup}\PY{p}{(}\PY{p}{)} \PY{o}{\PYZlt{}} \PY{p}{(}\PY{n}{NUM\PYZus{}AUTHORS}\PY{o}{\PYZhy{}}\PY{n}{OPEN\PYZus{}SET\PYZus{}NUM\PYZus{}AUTHORS}\PY{p}{)}\PY{p}{]}
\PY{n}{print\PYZus{}stats\PYZus{}dataset}\PY{p}{(}\PY{n}{df\PYZus{}train}\PY{p}{)}
\PY{n}{df\PYZus{}train}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Numero di testi totale: 2250
Numero di testi per autore in media: 50.0
Numero di autori: 45
Lunghezza media testo per autore in media: 3119.268444444445
\end{Verbatim}

            \begin{tcolorbox}[breakable, boxrule=.5pt, size=fbox, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{16}{\hspace{3.5pt}}
\begin{Verbatim}[commandchars=\\\{\}]
   Unnamed: 0  {\ldots}              author
0           1  {\ldots}        David Lawder
1          10  {\ldots}    Patricia Commins
2          27  {\ldots}  Catherine O'Mahony
3          30  {\ldots}  Catherine O'Mahony
4          42  {\ldots}  Catherine O'Mahony

[5 rows x 3 columns]
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{17}{\hspace{4pt}}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} get difference between dataset and df\PYZus{}train for df\PYZus{}test}
\PY{n}{df\PYZus{}test} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{[}\PY{n}{dataset}\PY{p}{,}\PY{n}{df\PYZus{}train}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{drop\PYZus{}duplicates}\PY{p}{(}\PY{n}{keep}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
\PY{n}{print\PYZus{}stats\PYZus{}dataset}\PY{p}{(}\PY{n}{df\PYZus{}test}\PY{p}{)}
\PY{n}{df\PYZus{}test}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Numero di testi totale: 2750
Numero di testi per autore in media: 55.0
Numero di autori: 50
Lunghezza media testo per autore in media: 3192.933000000001
\end{Verbatim}

            \begin{tcolorbox}[breakable, boxrule=.5pt, size=fbox, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{17}{\hspace{3.5pt}}
\begin{Verbatim}[commandchars=\\\{\}]
    Unnamed: 0  {\ldots}           author
26        2632  {\ldots}   William Boston
29        2780  {\ldots}  Therese Poletti
36        3185  {\ldots}  Therese Poletti
46        4615  {\ldots}   William Boston
58        5459  {\ldots}  Therese Poletti

[5 rows x 3 columns]
\end{Verbatim}
\end{tcolorbox}
        
    \subsection{=\textgreater{} Extracting
features}\label{extracting-features}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{18}{\hspace{4pt}}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{tfidf\PYZus{}fit\PYZus{}transform}\PY{p}{(}\PY{p}{)}\PY{p}{:}
  \PY{c+c1}{\PYZsh{} df\PYZus{}train, df\PYZus{}test = train\PYZus{}test\PYZus{}split(dataset, test\PYZus{}size=0.5, random\PYZus{}state=0)}
  \PY{n}{tfidf\PYZus{}train} \PY{o}{=} \PY{n}{tfidf\PYZus{}vec}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{df\PYZus{}train}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{articles}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
  \PY{n}{tfidf\PYZus{}test} \PY{o}{=} \PY{n}{tfidf\PYZus{}vec}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{df\PYZus{}test}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{articles}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
  \PY{k}{return} \PY{n}{tfidf\PYZus{}train}\PY{p}{,} \PY{n}{tfidf\PYZus{}test}

\PY{k}{def} \PY{n+nf}{counter\PYZus{}fit\PYZus{}transform}\PY{p}{(}\PY{p}{)}\PY{p}{:}
  \PY{n}{counter\PYZus{}train} \PY{o}{=} \PY{n}{counter\PYZus{}vect}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{df\PYZus{}train}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{articles}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
  \PY{n}{counter\PYZus{}test} \PY{o}{=} \PY{n}{counter\PYZus{}vect}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{df\PYZus{}test}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{articles}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
  \PY{k}{return} \PY{n}{counter\PYZus{}train}\PY{p}{,} \PY{n}{counter\PYZus{}test}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{19}{\hspace{4pt}}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{le} \PY{o}{=} \PY{n}{LabelEncoder}\PY{p}{(}\PY{p}{)}
\PY{n}{df\PYZus{}train}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{target}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{le}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{df\PYZus{}train}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{author}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\PY{n}{df\PYZus{}test}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{author}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df\PYZus{}test}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{author}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{k}{lambda} \PY{n}{s}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZlt{}unknown\PYZgt{}}\PY{l+s+s1}{\PYZsq{}} \PY{k}{if} \PY{n}{s} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{le}\PY{o}{.}\PY{n}{classes\PYZus{}} \PY{k}{else} \PY{n}{s}\PY{p}{)}
\PY{n}{le}\PY{o}{.}\PY{n}{classes\PYZus{}} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{le}\PY{o}{.}\PY{n}{classes\PYZus{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZlt{}unknown\PYZgt{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{df\PYZus{}test}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{target}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}  \PY{o}{=} \PY{n}{le}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{df\PYZus{}test}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{author}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    While above models tried to use the classify the articles based on the
words and their frequencies, I will try to build a sequence model that
tries to capture the writing style of an author. However, I am dubious
about the effectiveness of these models considering the limited amount
of data.

I will change the tokenizer by removing stem as I am going to replace
words with Glove embeddings that provide relevant words vectors to all
verb forms of a word. Below are the changes that I will make:

Remove words in the quotes as they don't contribute to capture the
writing style of the author. Not stemming the words to replace the words
with corresponsing Glove vectors Not removing stop words, as some
authors whose articles aren't published online may not hesitate to use
lot of stop words

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{20}{\hspace{4pt}}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{build\PYZus{}custom\PYZus{}w2v\PYZus{}model}\PY{p}{(}\PY{p}{)}\PY{p}{:}
  \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
  \PY{k+kn}{import} \PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{backend} \PY{k}{as} \PY{n+nn}{K}
  \PY{k+kn}{from} \PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{models} \PY{k}{import} \PY{n}{Sequential}
  \PY{k+kn}{from} \PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{layers} \PY{k}{import} \PY{n}{Dense}\PY{p}{,} \PY{n}{Embedding}\PY{p}{,} \PY{n}{Lambda}
  \PY{k+kn}{from} \PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{utils} \PY{k}{import} \PY{n}{np\PYZus{}utils}
  \PY{k+kn}{from} \PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{preprocessing} \PY{k}{import} \PY{n}{sequence}
  \PY{k+kn}{from} \PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{preprocessing}\PY{n+nn}{.}\PY{n+nn}{text} \PY{k}{import} \PY{n}{Tokenizer}
  \PY{k+kn}{import} \PY{n+nn}{gensim}
  \PY{n}{vectorize} \PY{o}{=} \PY{n}{Tokenizer}\PY{p}{(}\PY{p}{)}
  \PY{n}{vectorize}\PY{o}{.}\PY{n}{fit\PYZus{}on\PYZus{}texts}\PY{p}{(}\PY{n}{dataset}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{articles}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
  \PY{n}{data} \PY{o}{=} \PY{n}{vectorize}\PY{o}{.}\PY{n}{texts\PYZus{}to\PYZus{}sequences}\PY{p}{(}\PY{n}{dataset}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{articles}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
  \PY{n}{total\PYZus{}vocab} \PY{o}{=} \PY{n+nb}{sum}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{s}\PY{p}{)} \PY{k}{for} \PY{n}{s} \PY{o+ow}{in} \PY{n}{data}\PY{p}{)}
  \PY{n}{word\PYZus{}count} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{vectorize}\PY{o}{.}\PY{n}{word\PYZus{}index}\PY{p}{)} \PY{o}{+} \PY{l+m+mi}{1}
  \PY{n}{window\PYZus{}size} \PY{o}{=} \PY{l+m+mi}{2}
  \PY{n+nb}{print}\PY{p}{(}\PY{n}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{total vocab: }\PY{l+s+si}{\PYZob{}total\PYZus{}vocab\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
  \PY{n+nb}{print}\PY{p}{(}\PY{n}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{word count: }\PY{l+s+si}{\PYZob{}word\PYZus{}count\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}

  \PY{k}{def} \PY{n+nf}{cbow\PYZus{}model}\PY{p}{(}\PY{n}{data}\PY{p}{,} \PY{n}{window\PYZus{}size}\PY{p}{,} \PY{n}{total\PYZus{}vocab}\PY{p}{)}\PY{p}{:}
      \PY{n}{total\PYZus{}length} \PY{o}{=} \PY{n}{window\PYZus{}size}\PY{o}{*}\PY{l+m+mi}{2}
      \PY{k}{for} \PY{n}{text} \PY{o+ow}{in} \PY{n}{data}\PY{p}{:}
          \PY{n}{text\PYZus{}len} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{text}\PY{p}{)}
          \PY{k}{for} \PY{n}{idx}\PY{p}{,} \PY{n}{word} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{text}\PY{p}{)}\PY{p}{:}
              \PY{n}{context\PYZus{}word} \PY{o}{=} \PY{p}{[}\PY{p}{]}
              \PY{n}{target}   \PY{o}{=} \PY{p}{[}\PY{p}{]}            
              \PY{n}{begin} \PY{o}{=} \PY{n}{idx} \PY{o}{\PYZhy{}} \PY{n}{window\PYZus{}size}
              \PY{n}{end} \PY{o}{=} \PY{n}{idx} \PY{o}{+} \PY{n}{window\PYZus{}size} \PY{o}{+} \PY{l+m+mi}{1}
              \PY{n}{context\PYZus{}word}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{[}\PY{n}{text}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{begin}\PY{p}{,} \PY{n}{end}\PY{p}{)} \PY{k}{if} \PY{l+m+mi}{0} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{n}{i} \PY{o}{\PYZlt{}} \PY{n}{text\PYZus{}len} \PY{o+ow}{and} \PY{n}{i} \PY{o}{!=} \PY{n}{idx}\PY{p}{]}\PY{p}{)}
              \PY{n}{target}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{word}\PY{p}{)}
              \PY{n}{contextual} \PY{o}{=} \PY{n}{sequence}\PY{o}{.}\PY{n}{pad\PYZus{}sequences}\PY{p}{(}\PY{n}{context\PYZus{}word}\PY{p}{,} \PY{n}{maxlen}\PY{o}{=}\PY{n}{total\PYZus{}length}\PY{p}{)}
              \PY{n}{final\PYZus{}target} \PY{o}{=} \PY{n}{np\PYZus{}utils}\PY{o}{.}\PY{n}{to\PYZus{}categorical}\PY{p}{(}\PY{n}{target}\PY{p}{,} \PY{n}{total\PYZus{}vocab}\PY{p}{)}
              \PY{k}{yield}\PY{p}{(}\PY{n}{contextual}\PY{p}{,} \PY{n}{final\PYZus{}target}\PY{p}{)} 

  \PY{n}{model} \PY{o}{=} \PY{n}{Sequential}\PY{p}{(}\PY{p}{)}
  \PY{n}{model}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Embedding}\PY{p}{(}\PY{n}{input\PYZus{}dim}\PY{o}{=}\PY{n}{total\PYZus{}vocab}\PY{p}{,} \PY{n}{output\PYZus{}dim}\PY{o}{=}\PY{l+m+mi}{100}\PY{p}{,} \PY{n}{input\PYZus{}length}\PY{o}{=}\PY{n}{window\PYZus{}size}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}
  \PY{n}{model}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Lambda}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{n}{K}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,} \PY{n}{output\PYZus{}shape}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{100}\PY{p}{,}\PY{p}{)}\PY{p}{)}\PY{p}{)}
  \PY{n}{model}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Dense}\PY{p}{(}\PY{n}{total\PYZus{}vocab}\PY{p}{,} \PY{n}{activation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{softmax}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
  \PY{n}{model}\PY{o}{.}\PY{n}{compile}\PY{p}{(}\PY{n}{loss}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{categorical\PYZus{}crossentropy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{optimizer}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{adam}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
  \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{:}
      \PY{n}{cost} \PY{o}{=} \PY{l+m+mi}{0}
      \PY{k}{for} \PY{n}{contextual}\PY{p}{,} \PY{n}{final\PYZus{}target} \PY{o+ow}{in} \PY{n}{cbow\PYZus{}model}\PY{p}{(}\PY{n}{data}\PY{p}{,} \PY{n}{window\PYZus{}size}\PY{p}{,} \PY{n}{total\PYZus{}vocab}\PY{p}{)}\PY{p}{:}
          \PY{n}{cost} \PY{o}{+}\PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{train\PYZus{}on\PYZus{}batch}\PY{p}{(}\PY{n}{contextual}\PY{p}{,} \PY{n}{final\PYZus{}target}\PY{p}{)}
      \PY{n+nb}{print}\PY{p}{(}\PY{n}{i}\PY{p}{,} \PY{n}{cost}\PY{p}{)}
  \PY{n}{dimensions}\PY{o}{=}\PY{l+m+mi}{100}
  \PY{n}{vect\PYZus{}file} \PY{o}{=} \PY{n+nb}{open}\PY{p}{(}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{dirname}\PY{p}{(}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{base\PYZus{}dir}\PY{p}{,} \PY{n}{DATASET\PYZus{}FILENAME}\PY{p}{)}\PY{p}{)}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vectors.txt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{w}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
  \PY{n}{vect\PYZus{}file}\PY{o}{.}\PY{n}{write}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{ }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{total\PYZus{}vocab}\PY{p}{,}\PY{n}{dimensions}\PY{p}{)}\PY{p}{)}
  \PY{n}{weights} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{get\PYZus{}weights}\PY{p}{(}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
  \PY{k}{for} \PY{n}{text}\PY{p}{,} \PY{n}{i} \PY{o+ow}{in} \PY{n}{vectorize}\PY{o}{.}\PY{n}{word\PYZus{}index}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{:}
      \PY{n}{final\PYZus{}vec} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ }\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n+nb}{map}\PY{p}{(}\PY{n+nb}{str}\PY{p}{,} \PY{n+nb}{list}\PY{p}{(}\PY{n}{weights}\PY{p}{[}\PY{n}{i}\PY{p}{,} \PY{p}{:}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{)}
      \PY{n}{vect\PYZus{}file}\PY{o}{.}\PY{n}{write}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{ }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{text}\PY{p}{,} \PY{n}{final\PYZus{}vec}\PY{p}{)}\PY{p}{)}
  \PY{n}{vect\PYZus{}file}\PY{o}{.}\PY{n}{close}\PY{p}{(}\PY{p}{)}

\PY{k}{if} \PY{n}{USE\PYZus{}W2V} \PY{o+ow}{and} \PY{o+ow}{not} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{exists}\PY{p}{(}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{dirname}\PY{p}{(}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{base\PYZus{}dir}\PY{p}{,} \PY{n}{DATASET\PYZus{}FILENAME}\PY{p}{)}\PY{p}{)}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vectors.txt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}
  \PY{n}{build\PYZus{}custom\PYZus{}w2v\PYZus{}model}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{21}{\hspace{4pt}}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{gensim}\PY{n+nn}{.}\PY{n+nn}{scripts}\PY{n+nn}{.}\PY{n+nn}{glove2word2vec} \PY{k}{import} \PY{n}{glove2word2vec}
\PY{k+kn}{from} \PY{n+nn}{gensim}\PY{n+nn}{.}\PY{n+nn}{models} \PY{k}{import} \PY{n}{KeyedVectors}

\PY{k}{class} \PY{n+nc}{Word2VecVectorizer}\PY{p}{:}
  \PY{k}{def} \PY{n+nf}{\PYZus{}\PYZus{}init\PYZus{}\PYZus{}}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{model}\PY{p}{)}\PY{p}{:}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Loading in word vectors...}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{word\PYZus{}vectors} \PY{o}{=} \PY{n}{model}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Finished loading in word vectors}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}

  \PY{k}{def} \PY{n+nf}{fit}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{data}\PY{p}{)}\PY{p}{:}
    \PY{k}{pass}

  \PY{k}{def} \PY{n+nf}{transform}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{data}\PY{p}{)}\PY{p}{:}
    \PY{c+c1}{\PYZsh{} determine the dimensionality of vectors}
    \PY{n}{v} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{word\PYZus{}vectors}\PY{o}{.}\PY{n}{get\PYZus{}vector}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{king}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{D} \PY{o}{=} \PY{n}{v}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}

    \PY{n}{X} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{data}\PY{p}{)}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{D}\PY{p}{)}\PY{p}{)}
    \PY{n}{n} \PY{o}{=} \PY{l+m+mi}{0}
    \PY{n}{emptycount} \PY{o}{=} \PY{l+m+mi}{0}
    \PY{k}{for} \PY{n}{sentence} \PY{o+ow}{in} \PY{n}{data}\PY{p}{:}
      \PY{n}{tokens} \PY{o}{=} \PY{n}{sentence}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{p}{)}
      \PY{n}{vecs} \PY{o}{=} \PY{p}{[}\PY{p}{]}
      \PY{n}{m} \PY{o}{=} \PY{l+m+mi}{0}
      \PY{k}{for} \PY{n}{word} \PY{o+ow}{in} \PY{n}{tokens}\PY{p}{:}
        \PY{k}{try}\PY{p}{:}
          \PY{c+c1}{\PYZsh{} throws KeyError if word not found}
          \PY{n}{vec} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{word\PYZus{}vectors}\PY{o}{.}\PY{n}{get\PYZus{}vector}\PY{p}{(}\PY{n}{word}\PY{p}{)}
          \PY{n}{vecs}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{vec}\PY{p}{)}
          \PY{n}{m} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
        \PY{k}{except} \PY{n+ne}{KeyError}\PY{p}{:}
          \PY{k}{pass}
      \PY{k}{if} \PY{n+nb}{len}\PY{p}{(}\PY{n}{vecs}\PY{p}{)} \PY{o}{\PYZgt{}} \PY{l+m+mi}{0}\PY{p}{:}
        \PY{n}{vecs} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{vecs}\PY{p}{)}
        \PY{n}{X}\PY{p}{[}\PY{n}{n}\PY{p}{]} \PY{o}{=} \PY{n}{vecs}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
      \PY{k}{else}\PY{p}{:}
        \PY{n}{emptycount} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
      \PY{n}{n} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Numer of samples with no words found: }\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ / }\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{emptycount}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{data}\PY{p}{)}\PY{p}{)}\PY{p}{)}
    \PY{k}{return} \PY{n}{X}


  \PY{k}{def} \PY{n+nf}{fit\PYZus{}transform}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{data}\PY{p}{)}\PY{p}{:}
    \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{data}\PY{p}{)}
    \PY{k}{return} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{data}\PY{p}{)}

\PY{k}{def} \PY{n+nf}{w2v\PYZus{}fit\PYZus{}transform}\PY{p}{(}\PY{p}{)}\PY{p}{:}
  \PY{n}{USE\PYZus{}GLOVE} \PY{o}{=} \PY{k+kc}{False}
  \PY{k}{if} \PY{n}{USE\PYZus{}GLOVE}\PY{p}{:}
    \PY{n}{glove\PYZus{}path} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{base\PYZus{}dir}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{glove.6B.50d.txt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{word2vec\PYZus{}output\PYZus{}file} \PY{o}{=} \PY{n}{glove\PYZus{}path}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.word2vec}\PY{l+s+s1}{\PYZsq{}}
    \PY{k}{if} \PY{o+ow}{not} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{exists}\PY{p}{(}\PY{n}{word2vec\PYZus{}output\PYZus{}file}\PY{p}{)}\PY{p}{:}
      \PY{n}{glove2word2vec}\PY{p}{(}\PY{n}{glove\PYZus{}path}\PY{p}{,} \PY{n}{word2vec\PYZus{}output\PYZus{}file}\PY{p}{)}
  \PY{k}{else}\PY{p}{:}
    \PY{n}{word2vec\PYZus{}output\PYZus{}file} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{dirname}\PY{p}{(}
        \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{base\PYZus{}dir}\PY{p}{,} \PY{n}{DATASET\PYZus{}FILENAME}\PY{p}{)}\PY{p}{)}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vectors.txt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
  \PY{n}{model} \PY{o}{=} \PY{n}{KeyedVectors}\PY{o}{.}\PY{n}{load\PYZus{}word2vec\PYZus{}format}\PY{p}{(}\PY{n}{word2vec\PYZus{}output\PYZus{}file}\PY{p}{,} \PY{n}{binary}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}

  \PY{c+c1}{\PYZsh{} Set a word vectorizer}
  \PY{n}{vectorizer} \PY{o}{=} \PY{n}{Word2VecVectorizer}\PY{p}{(}\PY{n}{model}\PY{p}{)}
  \PY{c+c1}{\PYZsh{} Get the sentence embeddings for the train dataset}
  \PY{n}{w2v\PYZus{}train} \PY{o}{=} \PY{n}{vectorizer}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{df\PYZus{}train}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{articles}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
  \PY{c+c1}{\PYZsh{} Get the sentence embeddings for the test dataset}
  \PY{n}{w2v\PYZus{}test} \PY{o}{=} \PY{n}{vectorizer}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{df\PYZus{}test}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{articles}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
  \PY{n+nb}{print}\PY{p}{(}\PY{n}{w2v\PYZus{}train}\PY{o}{.}\PY{n}{shape}\PY{p}{,}\PY{n}{w2v\PYZus{}test}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
  \PY{k}{return} \PY{n}{w2v\PYZus{}train}\PY{p}{,} \PY{n}{w2v\PYZus{}test}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{22}{\hspace{4pt}}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{teapot\PYZus{}search}\PY{p}{(}\PY{p}{)}\PY{p}{:}
  \PY{k+kn}{from} \PY{n+nn}{tpot} \PY{k}{import} \PY{n}{TPOTClassifier}\PY{p}{,} \PY{n}{TPOTRegressor}
  \PY{c+c1}{\PYZsh{}tpot\PYZus{}settings = dict(verbosity=2, random\PYZus{}state = 1234, scoring = \PYZsq{}accuracy\PYZsq{}, warm\PYZus{}start = True, config\PYZus{}dict=\PYZsq{}TPOT sparse\PYZsq{})}
  \PY{c+c1}{\PYZsh{}auto\PYZus{}reg = TPOTRegressor(generations=2, population\PYZus{}size=5, **tpot\PYZus{}settings)}
  \PY{c+c1}{\PYZsh{}auto\PYZus{}reg.fit(tfidf\PYZus{}train, df\PYZus{}train[\PYZsq{}target\PYZsq{}])}
  \PY{c+c1}{\PYZsh{}print(auto\PYZus{}reg.score(tfidf\PYZus{}test, df\PYZus{}test[\PYZsq{}target\PYZsq{}]))}
  \PY{c+c1}{\PYZsh{}auto\PYZus{}reg.export(\PYZsq{}tpot\PYZus{}exported\PYZus{}pipeline.py\PYZsq{})}
  \PY{c+c1}{\PYZsh{}pipeline\PYZus{}optimizer = TPOTClassifier()}
  \PY{n}{pipeline\PYZus{}optimizer} \PY{o}{=} \PY{n}{TPOTClassifier}\PY{p}{(}\PY{n}{generations}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{,} \PY{n}{population\PYZus{}size}\PY{o}{=}\PY{l+m+mi}{20}\PY{p}{,} \PY{n}{cv}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{,}
                                      \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{42}\PY{p}{,} \PY{n}{verbosity}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{scoring}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{accuracy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{config\PYZus{}dict}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{TPOT sparse}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
  \PY{n}{pipeline\PYZus{}optimizer}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{tfidf\PYZus{}train}\PY{p}{,} \PY{n}{df\PYZus{}train}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{target}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
  \PY{n+nb}{print}\PY{p}{(}\PY{n}{pipeline\PYZus{}optimizer}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{tfidf\PYZus{}test}\PY{p}{,} \PY{n}{df\PYZus{}test}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{target}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}
  \PY{n}{pipeline\PYZus{}optimizer}\PY{o}{.}\PY{n}{export}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tpot\PYZus{}exported\PYZus{}pipeline.py}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{23}{\hspace{4pt}}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{use\PYZus{}features}\PY{p}{(}\PY{n}{tfidf}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,} \PY{n}{bow}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,} \PY{n}{w2v}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{p}{:}
  \PY{k}{if} \PY{n}{tfidf}\PY{p}{:}
    \PY{k}{return} \PY{n}{tfidf\PYZus{}fit\PYZus{}transform}\PY{p}{(}\PY{p}{)}
  \PY{k}{elif} \PY{n}{bow}\PY{p}{:}
    \PY{k}{return} \PY{n}{counter\PYZus{}fit\PYZus{}transform}\PY{p}{(}\PY{p}{)}
  \PY{k}{elif} \PY{n}{w2v}\PY{p}{:}
    \PY{k}{return} \PY{n}{w2v\PYZus{}fit\PYZus{}transform}\PY{p}{(}\PY{p}{)}
  \PY{k}{else}\PY{p}{:}
    \PY{k}{return} \PY{n}{tfidf\PYZus{}train}\PY{p}{,} \PY{n}{tfidf\PYZus{}test}

\PY{n}{training\PYZus{}features}\PY{p}{,} \PY{n}{testing\PYZus{}features} \PY{o}{=} \PY{n}{use\PYZus{}features}\PY{p}{(}\PY{n}{tfidf}\PY{o}{=}\PY{n}{USE\PYZus{}TFIDF}\PY{p}{,} \PY{n}{bow}\PY{o}{=}\PY{n}{USE\PYZus{}BOW}\PY{p}{,} \PY{n}{w2v}\PY{o}{=}\PY{n}{USE\PYZus{}W2V}\PY{p}{)}
\PY{n}{training\PYZus{}target} \PY{o}{=} \PY{n}{df\PYZus{}train}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{target}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\PY{n}{testing\PYZus{}target} \PY{o}{=} \PY{n}{df\PYZus{}test}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{target}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{training\PYZus{}target}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{testing\PYZus{}target}\PY{p}{)}
\PY{n}{training\PYZus{}features}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
0        9
1       36
2        5
3        5
4        5
        ..
2495    10
2496    10
2497    10
2498    10
2499    10
Name: target, Length: 2250, dtype: int64
26      45
29      45
36      45
46      45
58      45
        ..
4995    34
4996    34
4997    34
4998    34
4999    34
Name: target, Length: 2750, dtype: int64
\end{Verbatim}

            \begin{tcolorbox}[breakable, boxrule=.5pt, size=fbox, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{23}{\hspace{3.5pt}}
\begin{Verbatim}[commandchars=\\\{\}]
<2250x2527 sparse matrix of type '<class 'numpy.float64'>'
        with 370970 stored elements in Compressed Sparse Row format>
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{24}{\hspace{4pt}}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{training\PYZus{}features}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, boxrule=.5pt, size=fbox, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{24}{\hspace{3.5pt}}
\begin{Verbatim}[commandchars=\\\{\}]
<2250x2527 sparse matrix of type '<class 'numpy.float64'>'
        with 370970 stored elements in Compressed Sparse Row format>
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{25}{\hspace{4pt}}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{double\PYZus{}pipeline}\PY{p}{(}\PY{p}{)}\PY{p}{:}
  \PY{c+c1}{\PYZsh{} Average CV score on the training set was: 0.9173333333333333}
  \PY{n}{exported\PYZus{}pipeline} \PY{o}{=} \PY{n}{make\PYZus{}pipeline}\PY{p}{(}
      \PY{n}{make\PYZus{}union}\PY{p}{(}
          \PY{n}{FunctionTransformer}\PY{p}{(}\PY{n}{copy}\PY{p}{)}\PY{p}{,}
          \PY{n}{SelectFwe}\PY{p}{(}\PY{n}{score\PYZus{}func}\PY{o}{=}\PY{n}{f\PYZus{}classif}\PY{p}{,} \PY{n}{alpha}\PY{o}{=}\PY{l+m+mf}{0.004}\PY{p}{)}
      \PY{p}{)}\PY{p}{,}
      \PY{n}{LinearSVC}\PY{p}{(}\PY{n}{C}\PY{o}{=}\PY{l+m+mf}{20.0}\PY{p}{,} \PY{n}{dual}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,} \PY{n}{loss}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{squared\PYZus{}hinge}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{penalty}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{l2}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{tol}\PY{o}{=}\PY{l+m+mf}{0.01}\PY{p}{)}
  \PY{p}{)}
  \PY{c+c1}{\PYZsh{} Fix random state for all the steps in exported pipeline}
  \PY{n}{set\PYZus{}param\PYZus{}recursive}\PY{p}{(}\PY{n}{exported\PYZus{}pipeline}\PY{o}{.}\PY{n}{steps}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{random\PYZus{}state}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{42}\PY{p}{)}
  \PY{k}{return} \PY{n}{exported\PYZus{}pipeline}

\PY{k}{def} \PY{n+nf}{single\PYZus{}pipeline}\PY{p}{(}\PY{p}{)}\PY{p}{:}
  \PY{c+c1}{\PYZsh{} Average CV score on the training set was: 0.6912}
  \PY{n}{exported\PYZus{}pipeline} \PY{o}{=} \PY{n}{LinearSVC}\PY{p}{(}\PY{n}{C}\PY{o}{=}\PY{l+m+mf}{20.0}\PY{p}{,} \PY{n}{dual}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{loss}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{hinge}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{penalty}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{l2}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{tol}\PY{o}{=}\PY{l+m+mf}{0.0001}\PY{p}{)}
  \PY{c+c1}{\PYZsh{} Fix random state in exported estimator}
  \PY{k}{if} \PY{n+nb}{hasattr}\PY{p}{(}\PY{n}{exported\PYZus{}pipeline}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{random\PYZus{}state}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{:}
      \PY{n+nb}{setattr}\PY{p}{(}\PY{n}{exported\PYZus{}pipeline}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{random\PYZus{}state}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{42}\PY{p}{)}
  \PY{k}{return} \PY{n}{exported\PYZus{}pipeline}

\PY{k}{def} \PY{n+nf}{onevsrestclassifier}\PY{p}{(}\PY{p}{)}\PY{p}{:}
  \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{multiclass} \PY{k}{import} \PY{n}{OneVsRestClassifier}
  \PY{k}{return} \PY{n}{OneVsRestClassifier}\PY{p}{(}\PY{n}{LinearSVC}\PY{p}{(}\PY{n}{C}\PY{o}{=}\PY{l+m+mf}{20.0}\PY{p}{,} \PY{n}{dual}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{loss}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{hinge}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{penalty}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{l2}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{tol}\PY{o}{=}\PY{l+m+mf}{0.0001}\PY{p}{,} \PY{n}{multi\PYZus{}class}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ovr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{42}\PY{p}{,} \PY{n}{max\PYZus{}iter}\PY{o}{=}\PY{l+m+mi}{10000}\PY{p}{)}\PY{p}{)}

\PY{k}{def} \PY{n+nf}{onevsrestclassifier\PYZus{}combined}\PY{p}{(}\PY{p}{)}\PY{p}{:}
  \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{multiclass} \PY{k}{import} \PY{n}{OneVsRestClassifier}
  \PY{n}{exported\PYZus{}pipeline} \PY{o}{=} \PY{n}{make\PYZus{}pipeline}\PY{p}{(}
      \PY{n}{make\PYZus{}union}\PY{p}{(}
          \PY{n}{FunctionTransformer}\PY{p}{(}\PY{n}{copy}\PY{p}{)}\PY{p}{,}
          \PY{n}{SelectFwe}\PY{p}{(}\PY{n}{score\PYZus{}func}\PY{o}{=}\PY{n}{f\PYZus{}classif}\PY{p}{,} \PY{n}{alpha}\PY{o}{=}\PY{l+m+mf}{0.004}\PY{p}{)}
      \PY{p}{)}\PY{p}{,}
      \PY{n}{OneVsRestClassifier}\PY{p}{(}\PY{n}{LinearSVC}\PY{p}{(}\PY{n}{C}\PY{o}{=}\PY{l+m+mf}{20.0}\PY{p}{,} \PY{n}{dual}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,} \PY{n}{loss}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{squared\PYZus{}hinge}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{penalty}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{l2}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{tol}\PY{o}{=}\PY{l+m+mf}{0.01}\PY{p}{)}\PY{p}{)}
  \PY{p}{)}
  \PY{c+c1}{\PYZsh{} Fix random state for all the steps in exported pipeline}
  \PY{n}{set\PYZus{}param\PYZus{}recursive}\PY{p}{(}\PY{n}{exported\PYZus{}pipeline}\PY{o}{.}\PY{n}{steps}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{random\PYZus{}state}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{42}\PY{p}{)}
  \PY{k}{return} \PY{n}{exported\PYZus{}pipeline}

\PY{k}{def} \PY{n+nf}{one\PYZus{}class\PYZus{}classifier}\PY{p}{(}\PY{p}{)}\PY{p}{:}
  \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{svm} \PY{k}{import} \PY{n}{OneClassSVM}
  \PY{k}{return} \PY{n}{OneClassSVM}\PY{p}{(}\PY{p}{)}

\PY{k}{def} \PY{n+nf}{select\PYZus{}features\PYZus{}for\PYZus{}author}\PY{p}{(}\PY{n}{author\PYZus{}selected}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{:}
  \PY{n}{training\PYZus{}features\PYZus{}new} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{p}{]}\PY{p}{)}
  \PY{k}{for} \PY{n}{index}\PY{p}{,} \PY{n}{author\PYZus{}id} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{training\PYZus{}target}\PY{p}{)}\PY{p}{:}
      \PY{k}{if} \PY{n}{author\PYZus{}id} \PY{o}{!=} \PY{n}{author\PYZus{}selected}\PY{p}{:}
        \PY{n}{training\PYZus{}features\PYZus{}new} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{concatenate}\PY{p}{(}\PY{p}{(}\PY{n}{training\PYZus{}features\PYZus{}new}\PY{p}{,} \PY{n}{training\PYZus{}features}\PY{p}{[}\PY{n}{index}\PY{p}{]}\PY{p}{)}\PY{p}{)}
  \PY{k}{return} \PY{n}{training\PYZus{}features\PYZus{}new}

\PY{k}{def} \PY{n+nf}{transform\PYZus{}testing\PYZus{}target}\PY{p}{(}\PY{n}{author\PYZus{}selected}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{:}
  \PY{n}{testing\PYZus{}target\PYZus{}new} \PY{o}{=} \PY{p}{[}\PY{p}{]}
  \PY{k}{for} \PY{n}{index}\PY{p}{,} \PY{n}{author\PYZus{}id} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{testing\PYZus{}target}\PY{p}{)}\PY{p}{:}
      \PY{k}{if} \PY{n}{author\PYZus{}id} \PY{o}{==} \PY{n}{author\PYZus{}selected}\PY{p}{:}
        \PY{n}{testing\PYZus{}target\PYZus{}new}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{)}
      \PY{k}{else}\PY{p}{:}
        \PY{n}{testing\PYZus{}target\PYZus{}new}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
  \PY{k}{return} \PY{n}{training\PYZus{}features\PYZus{}new}

\PY{n}{exported\PYZus{}pipeline} \PY{o}{=} \PY{n}{onevsrestclassifier}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{26}{\hspace{4pt}}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{exported\PYZus{}pipeline}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{training\PYZus{}features}\PY{p}{,} \PY{n}{training\PYZus{}target}\PY{p}{)}
\PY{n}{predicted} \PY{o}{=} \PY{n}{exported\PYZus{}pipeline}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{testing\PYZus{}features}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{27}{\hspace{4pt}}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{accuracy\PYZus{}result} \PY{o}{=} \PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{testing\PYZus{}target}\PY{p}{,} \PY{n}{predicted}\PY{p}{)}
\PY{n}{precision\PYZus{}result} \PY{o}{=} \PY{n}{precision\PYZus{}score}\PY{p}{(}\PY{n}{testing\PYZus{}target}\PY{p}{,} \PY{n}{predicted}\PY{p}{,} \PY{n}{average}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{macro}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{recall\PYZus{}result} \PY{o}{=} \PY{n}{recall\PYZus{}score}\PY{p}{(}\PY{n}{testing\PYZus{}target}\PY{p}{,} \PY{n}{predicted}\PY{p}{,} \PY{n}{average}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{macro}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{f1\PYZus{}result} \PY{o}{=} \PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{testing\PYZus{}target}\PY{p}{,} \PY{n}{predicted}\PY{p}{,} \PY{n}{average}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{macro}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
/usr/local/lib/python3.6/dist-packages/sklearn/metrics/\_classification.py:1272:
UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels
with no predicted samples. Use `zero\_division` parameter to control this
behavior.
  \_warn\_prf(average, modifier, msg\_start, len(result))
\end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{28}{\hspace{4pt}}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n+nb}{print}\PY{p}{(}\PY{n}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Accuracy: }\PY{l+s+si}{\PYZob{}accuracy\PYZus{}result\PYZcb{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{Precision: }\PY{l+s+si}{\PYZob{}precision\PYZus{}result\PYZcb{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{Recall: }\PY{l+s+si}{\PYZob{}recall\PYZus{}result\PYZcb{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{F1\PYZus{}macro: }\PY{l+s+si}{\PYZob{}f1\PYZus{}result\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Accuracy: 0.6305454545454545
Precision: 0.6427620459714135
Recall: 0.7539130434782608
F1\_macro: 0.6845925641835892
\end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{29}{\hspace{4pt}}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n+nb}{print}\PY{p}{(}\PY{n}{classification\PYZus{}report}\PY{p}{(}\PY{n}{testing\PYZus{}target}\PY{p}{,} \PY{n}{predicted}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
              precision    recall  f1-score   support

           0       0.57      0.86      0.69        50
           1       0.46      0.54      0.50        50
           2       0.78      0.86      0.82        50
           3       0.75      0.48      0.59        50
           4       0.56      0.74      0.64        50
           5       0.40      0.58      0.48        50
           6       0.94      0.90      0.92        50
           7       0.65      0.86      0.74        50
           8       0.51      0.74      0.61        50
           9       0.37      0.88      0.52        50
          10       0.76      0.88      0.81        50
          11       0.52      0.48      0.50        50
          12       0.53      0.66      0.59        50
          13       0.83      0.78      0.80        50
          14       0.98      0.96      0.97        50
          15       0.56      0.94      0.70        50
          16       0.69      0.70      0.69        50
          17       0.98      1.00      0.99        50
          18       0.55      0.74      0.63        50
          19       0.38      0.64      0.48        50
          20       0.60      0.82      0.69        50
          21       0.58      0.76      0.66        50
          22       0.63      0.78      0.70        50
          23       0.61      0.56      0.58        50
          24       0.60      0.80      0.68        50
          25       0.35      0.82      0.49        50
          26       0.63      0.96      0.76        50
          27       0.78      0.90      0.83        50
          28       0.70      0.62      0.66        50
          29       0.69      0.68      0.69        50
          30       0.78      0.70      0.74        50
          31       0.60      0.58      0.59        50
          32       0.98      1.00      0.99        50
          33       0.72      0.76      0.74        50
          34       0.64      0.74      0.69        50
          35       0.72      0.72      0.72        50
          36       0.65      0.70      0.67        50
          37       0.66      0.94      0.78        50
          38       0.64      0.78      0.70        50
          39       0.94      0.98      0.96        50
          40       0.53      0.38      0.44        50
          41       0.87      0.92      0.89        50
          42       0.67      0.98      0.80        50
          43       0.66      0.88      0.75        50
          44       0.56      0.70      0.62        50
          45       0.00      0.00      0.00       500

    accuracy                           0.63      2750
   macro avg       0.64      0.75      0.68      2750
weighted avg       0.54      0.63      0.57      2750

\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
/usr/local/lib/python3.6/dist-packages/sklearn/metrics/\_classification.py:1272:
UndefinedMetricWarning: Precision and F-score are ill-defined and being set to
0.0 in labels with no predicted samples. Use `zero\_division` parameter to
control this behavior.
  \_warn\_prf(average, modifier, msg\_start, len(result))
\end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{30}{\hspace{4pt}}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{o}{!}pip install \PYZhy{}q python\PYZhy{}telegram\PYZhy{}bot
\PY{k+kn}{from} \PY{n+nn}{telegram} \PY{k}{import} \PY{n}{Bot}
\PY{n}{bot} \PY{o}{=} \PY{n}{Bot}\PY{p}{(}\PY{n}{token}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{627493222:AAE8dqAHnrx9JJ3AGxDwb\PYZhy{}x2eiJqoXVBM8o}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{bot}\PY{o}{.}\PY{n}{send\PYZus{}message}\PY{p}{(}\PY{n}{text}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Training finito di OPEN\PYZus{}SET SVM }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s2}{ on }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s2}{ authors with }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s2}{ ndocs and }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s2}{ threshold}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{PROJECT\PYZus{}NAME}\PY{p}{,} \PY{n}{NUM\PYZus{}AUTHORS}\PY{p}{,} \PY{n}{N\PYZus{}DOCS}\PY{p}{,} \PY{n}{N\PYZus{}THRESHOLD}\PY{p}{)}\PY{p}{,} \PY{n}{chat\PYZus{}id}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{141928344}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
     |████████████████████████████████| 430kB 8.2MB/s
     |████████████████████████████████| 61kB 9.8MB/s
     |████████████████████████████████| 2.6MB 63.6MB/s
\end{Verbatim}

            \begin{tcolorbox}[breakable, boxrule=.5pt, size=fbox, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{30}{\hspace{3.5pt}}
\begin{Verbatim}[commandchars=\\\{\}]
<telegram.message.Message at 0x7fab7e6ddc18>
\end{Verbatim}
\end{tcolorbox}
        

    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
